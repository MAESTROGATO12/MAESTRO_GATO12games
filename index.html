<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Repetición</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
*{margin:0;padding:0;box-sizing:border-box}
body{
  background:#020617;
  color:#e5e7eb;
  font-family:system-ui, monospace;
}
@media(max-width:900px){
  body::before{
    content:"Repetición solo está disponible en PC";
    position:fixed;inset:0;
    background:#020617;
    color:white;
    display:flex;
    align-items:center;
    justify-content:center;
    z-index:9999;
  }
}
#game{
  max-width:900px;
  margin:auto;
  padding:40px;
}
h1,h2{
  font-weight:900;
  margin-bottom:20px;
}
p{
  margin-bottom:14px;
  line-height:1.6;
}
.choices{
  margin-top:30px;
  display:grid;
  gap:12px;
}
button{
  background:#020617;
  border:1px solid #1f2937;
  color:#e5e7eb;
  padding:14px;
  border-radius:10px;
  cursor:pointer;
  text-align:left;
}
button:hover{
  border-color:#22d3ee;
}
.hidden{display:none}
.end{
  font-size:1.4rem;
  color:#22d3ee;
}
.stat{
  font-size:.75rem;
  color:#6b7280;
  margin-top:40px;
  border-top:1px solid #1f2937;
  padding-top:10px;
}
</style>
</head>

<body>

<div id="game"></div>

<script>
/* =========================
   ESTADO GLOBAL DEL JUEGO
========================= */
let state = {
  act: 1,
  conciencia: 0,
  duda: 0,
  obediencia: 0,
  curiosidad: 0,
  rupturas: 0,
  loops: 0,
  visto: {}
};

/* =========================
   MOTOR
========================= */
const game = document.getElementById("game");

function render(text, choices=[]){
  game.innerHTML = "";
  text.forEach(t=>{
    const p=document.createElement("p");
    p.textContent=t;
    game.appendChild(p);
  });

  const c=document.createElement("div");
  c.className="choices";

  choices.forEach(ch=>{
    const b=document.createElement("button");
    b.textContent=ch.text;
    b.onclick=()=>ch.action();
    c.appendChild(b);
  });

  game.appendChild(c);
  renderStats();
}

function renderStats(){
  const s=document.createElement("div");
  s.className="stat";
  s.innerHTML=`
  conciencia:${state.conciencia} |
  duda:${state.duda} |
  obediencia:${state.obediencia} |
  curiosidad:${state.curiosidad} |
  rupturas:${state.rupturas} |
  repeticiones:${state.loops}
  `;
  game.appendChild(s);
}

/* =========================
   ACTO 1
========================= */
function start(){
  render([
    "Te despiertas.",
    "La habitación es la misma.",
    "Siempre es la misma."
  ],[
    {text:"Mirar alrededor",action:mirar},
    {text:"Cerrar los ojos",action:cerrarOjos},
    {text:"Levantarte",action:levantarte}
  ]);
}

function mirar(){
  state.curiosidad++;
  render([
    "No hay nada nuevo.",
    "Eso te inquieta más de lo que debería."
  ],[
    {text:"Aceptar que es normal",action:()=>{state.obediencia++; start()}},
    {text:"Pensar que ya viste esto antes",action:recuerdo}
  ]);
}

function cerrarOjos(){
  state.obediencia++;
  render([
    "Cierras los ojos.",
    "Nada cambia."
  ],[
    {text:"Abrirlos",action:start}
  ]);
}

function levantarte(){
  state.conciencia++;
  render([
    "Te levantas.",
    "La puerta está ahí.",
    "Siempre lo ha estado."
  ],[
    {text:"Abrir la puerta",action:puerta},
    {text:"No hacerlo",action:()=>{state.duda++; start()}}
  ]);
}

function recuerdo(){
  state.duda++;
  render([
    "Una sensación extraña.",
    "Como si esto ya hubiera ocurrido."
  ],[
    {text:"Ignorar el pensamiento",action:start},
    {text:"Explorar esa idea",action:acto2}
  ]);
}

/* =========================
   ACTO 2
========================= */
function acto2(){
  state.act=2;
  render([
    "ACTO II",
    "Empiezas a notar las repeticiones.",
    "El juego no las oculta."
  ],[
    {text:"Seguir jugando",action:ciclo},
    {text:"Buscar una salida",action:buscarSalida}
  ]);
}

function ciclo(){
  state.loops++;
  state.obediencia++;
  render([
    "Repites acciones.",
    "El sistema parece satisfecho."
  ],[
    {text:"Continuar",action:acto2},
    {text:"Romper el ciclo",action:romper}
  ]);
}

function buscarSalida(){
  state.curiosidad++;
  render([
    "No hay salida visible.",
    "Pero algo observa."
  ],[
    {text:"Hablar con ello",action:hablar},
    {text:"Callar",action:acto2}
  ]);
}

function hablar(){
  state.conciencia++;
  render([
    "— No deberías hacer eso.",
    "La voz suena como la tuya."
  ],[
    {text:"Preguntar quién es",action:acto3},
    {text:"Obedecer",action:acto2}
  ]);
}

function romper(){
  state.rupturas++;
  state.duda++;
  render([
    "Algo se rompe.",
    "No sabes qué, pero lo sientes."
  ],[
    {text:"Seguir",action:acto3}
  ]);
}

/* =========================
   ACTO 3
========================= */
function acto3(){
  state.act=3;
  render([
    "ACTO III",
    "El juego ya no finge.",
    "Todo depende de lo que hiciste antes."
  ],[
    {text:"Aceptar el sistema",action:finalObediencia},
    {text:"Negarlo",action:finalConciencia},
    {text:"Quedarte aquí",action:finalEstasis},
    {text:"Forzar el error",action:finalRuptura},
    {text:"Apagar el juego",action:finalMeta}
  ]);
}

/* =========================
   FINALES (5)
========================= */
function end(text){
  game.innerHTML="";
  const h=document.createElement("h2");
  h.className="end";
  h.textContent=text;
  game.appendChild(h);
}

function finalObediencia(){
  end("FINAL 1 — Obediencia\nEl sistema te conserva.");
}

function finalConciencia(){
  if(state.conciencia>=3){
    end("FINAL 2 — Conciencia\nSales, pero recuerdas todo.");
  }else{
    end("No estabas listo.");
  }
}

function finalEstasis(){
  end("FINAL 3 — Estasis\nEl tiempo no avanza.");
}

function finalRuptura(){
  if(state.rupturas>=2){
    end("FINAL 4 — Ruptura\nNada vuelve a ser igual.");
  }else{
    end("Fallaste al romperlo.");
  }
}

function finalMeta(){
  end("FINAL 5 — Meta\n¿De verdad cerraste el juego?");
}

/* ========================= */
start();
</script>

</body>
</html>
                                                                                                                 
